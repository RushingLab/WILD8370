<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab5: Priors • WILD8370</title>
<script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lab5: Priors">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">WILD8370</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2025.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-house-chimney"></span></a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../articles/syllabus.html"><span class="fa fab fa-readme"></span> Syllabus</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/schedule.html"><span class="fa far fa-calendar"></span> Schedule</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lectures" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa far fa-file-powerpoint"></span> Lectures</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lectures">
<li><a class="dropdown-item" href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/01_inference/01_inference.html">Lecture 1: Statistical inference in ecology</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/02_probability/02_probability.html">Lecture 2: Probability refresher</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/03_bayes/03_bayes.html">Lecture 3: Principles of Bayesian inference</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/04_intro_nimble/Intro_Nimble.html">Lecture 4: Introduction to Nimble</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/05_glms/05_glms.html">Lecture 5: Generalized linear model review</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/06_priors/06_priors.html">Lecture 6: More about priors</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/07_random_effects/07_random_effects.html">Lecture 7: Random vs. Fixed Effects</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/08_occupancy/08_occupancy.html">Lecture 8: State Space Models</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/09_NMix/09_NMix.html">Lecture 9: N-Mixture and Occupancy</a></li>
    <li><a class="dropdown-item" href="../articles/lectures/10_DynamicOcc/10_DynamicOcc.html">Lecture 10: Dynamic Occupancy Models</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-labs" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-laptop-code"></span> Labs</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-labs">
<li><a class="dropdown-item" href="../articles/lab01_intro_to_R.html">Lab 0: Introduction to R</a></li>
    <li><a class="dropdown-item" href="../articles/Lab01b_Mathematical_Notation.html">Lab 1: Mathematical Notation</a></li>
    <li><a class="dropdown-item" href="../articles/Lab2_simulation.html">Lab 2: Data Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/Lab3_BasicMCMC.html">Lab 3: Basic MCMC</a></li>
    <li><a class="dropdown-item" href="../articles/Lab4_glms.html">Lab 4: GLMs</a></li>
    <li><a class="dropdown-item" href="../articles/priors.html">Lab 5: Priors</a></li>
    <li><a class="dropdown-item" href="../articles/Lab6_MissingData.html">Lab 6: Missing Data</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-references" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa far fa-bookmark"></span> References</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-references">
<li><a class="dropdown-item" href="../articles/homework.html">Assignment instructions</a></li>
    <li><a class="dropdown-item" href="../articles/projects_and_directories.html">Projects and directories</a></li>
    <li><a class="dropdown-item" href="../articles/RMarkdown.html">R Markdown reference</a></li>
    <li><a class="dropdown-item" href="../articles/graphics.html">Creating publication-quality graphics</a></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Lab5: Priors</h1>
            
      

      <div class="d-none name"><code>priors.Rmd</code></div>
    </div>

    
    
<p>Given the practical and philosophical advantages of informative
priors, why aren’t they more common in ecological models? As already
discussed, one issue is cultural - many researchers are simply
uncomfortable with the <em>idea</em> of informative priors. <em>“If we
can choose any prior we want and that choice influences our inferences,
doesn’t that make the entire process too subjective?” “Shouldn’t we let
the data speak for itself?”</em> If one of these scientists is your
adviser or the reviewer of your manuscript, you may be forced to use
uninformative priors.</p>
<p>But another obstacle to using informative priors is that they can be
hard to formulate. How do we translate our domain expertise into a
probability distribution? How do we take a published estimate(s) of the
parameter value and turn it (or them) into a probability distribution?
The skills needed to translate prior knowledge into informative priors
are not generally taught in the statistics classes taken by most
ecologists.</p>
<p>In this activity, we’ll work through a few examples of ways to create
informative priors from a variety of types of information.</p>
<div class="section level2">
<h2 id="question-and-model-development">Question and model development<a class="anchor" aria-label="anchor" href="#question-and-model-development"></a>
</h2>
<p>One issue in many ecological studies is that it is logistically and
financially difficult to collect data from a large number of
individuals. As a result, vital rate estimates are often based on
relatively small sample sizes, which can lead to high uncertainty and
possibly spurious results.</p>
<p>It is precisely in these instances where Bayesian methods can shine -
as we saw in lecture, the ability to incorporate previous knowledge of
parameter values via informative priors is equivalent to increasing your
sample size.</p>
<p>To explore different ways of generating informative priors, we will
borrow data and some clever ideas from a recently published paper on the
dynamics of Polar Bear (<em>Ursus maritimus</em>) populations in the
Chukchi Sea (Regehr et al. 2018). For this example, we will focus on a
subset of the full model, namely estimating annual survival of adult
female bears.</p>
<p>In the model developed by Regehr et al. (2018), female survival was
identifiable but estimates were imprecise using only the available data
due to small sample sizes. As a result, the authors chose to develop
informative priors based on published survival estimates from other
populations. In this case, the authors were fortunate to have a handful
of previous studies to lean-on and later in this exercise we will learn
how they developed priors from those studies. But first, let’s assume
there are no published studies but we still want the benefits of
informative priors.</p>
</div>
<div class="section level2">
<h2 id="example-1-domain-expertise">Example 1: Domain expertise<a class="anchor" aria-label="anchor" href="#example-1-domain-expertise"></a>
</h2>
<p>Even if we have no previous estimates of polar bear survival, we are
not completely ignorant about survival of this species. We can use our
<em>domain expertise</em> to develop a prior that improves upon the
non-informative option.</p>
<p>Polar bears are a large, long-lived carnivore with a life expectancy
of about 20-25 years (Ramsay &amp; Stirling 1988). This simple fact
suggests that adult survival must be pretty high - even with an annual
survival probability of <span class="math inline">95\%</span>, an
individual would only have a 36% probability of surviving 20 years. So
survival probabilities much less than <span class="math inline">\sim
90\%</span> would be pretty surprising and we would be pretty suspicious
of estimates less than <span class="math inline">\sim 80\%</span> (which
would imply <span class="math inline">1\%</span> of female polar bears
make it to 20 years of age).</p>
<p>Of course, polar bear populations in many areas are declining pretty
quickly, suggesting that maybe adult survival rates could be lower than
historical levels. So although we can be pretty that survival is high
(e.g., <span class="math inline">&gt;80\%</span>), we’re not super
confident about the actual survival rate. With regards to our prior,
this suggests we want a prior that puts most of the weight <span class="math inline">&gt;80\%</span> but is wide enough to reflect our
uncertainty about the actual survival rates.</p>
<div class="section level3">
<h3 id="turning-our-expertise-into-a-prior">Turning our expertise into a prior<a class="anchor" aria-label="anchor" href="#turning-our-expertise-into-a-prior"></a>
</h3>
<p>When modeling a continuous random variable that must be between 0 and
1 (i.e., a probability), the beta distribution is a natural choice. The
shape of the beta distribution is governed by two parameters, <span class="math inline">\alpha</span> and <span class="math inline">\beta</span></p>
<p><img src="priors_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"></p>
<p>We learned in lecture how to turn the mean and variance of a random
variable into the parameters of a probability distribution using moment
matching. For the beta distribution:</p>
<p><span class="math display">\alpha = \bigg(\frac{1-\mu}{\sigma^2}-
\frac{1}{\mu} \bigg)\mu^2 \tag{1}</span><br><span class="math display">\beta = \alpha \bigg(\frac{1}{\mu}-1\bigg)
\tag{2}</span> Given our domain expertise, a reasonable choice for the
mean and variance of the prior might be <span class="math inline">\mu=0.9</span> and <span class="math inline">\sigma^2=0.005</span> (this may seem like a small
variance but as you’ll see below, it actually produces a relatively
diffuse prior. Figuring out an appropriate variance for probabilities is
not easy so the best option is usually to play with a few values and
then explore the properties of the resulting distribution to make sure
it seems reasonable). Plugging those values into equations 1 and 2
gives:</p>
<p><span class="math display">\alpha = \bigg(\frac{1-0.9}{0.005}-
\frac{1}{0.9} \bigg)0.9^2 = 15.3</span> <span class="math display">\beta
= 15.3 \bigg(\frac{1}{0.9}-1\bigg) = 1.7</span></p>
<p>As always, we should visualize this distribution to make sure it
matches what we think it should look like:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Target mean and variance</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.9</span></span>
<span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fl">0.005</span></span>
<span></span>
<span><span class="co">## Beta parameters</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="va">mu</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">mu</span><span class="op">)</span><span class="op">/</span><span class="va">var</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="va">alpha</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">mu</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Range of possible survival probabilities</span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">beta_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>phi <span class="op">=</span> <span class="va">phi</span>,</span>
<span>                      density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">phi</span>, <span class="va">alpha</span>, <span class="va">beta</span><span class="op">)</span>,</span>
<span>                      Approach <span class="op">=</span> <span class="st">"Domain expertise"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">beta_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">phi</span>, y <span class="op">=</span> <span class="va">density</span>, color <span class="op">=</span> <span class="va">Approach</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="priors_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
<p>This seems reasonable given our understanding of the species biology.
However, because we essentially made up the variance term to give a
relatively diffuse prior, we would likely have to be very careful about
how we justified this choice and would probably need to include some
formal prior sensitivity analyses.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-2-published-studies">Example 2: Published studies<a class="anchor" aria-label="anchor" href="#example-2-published-studies"></a>
</h2>
<p>Polar bears are relatively well-studied so we would not be surprised
to find at least a few published estimates of adult female survival. As
it turns out, there are. Estimates from a few of these studies are
included as a small data frame in the WILD8370 package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"SurvPriorData"</span><span class="op">)</span></span></code></pre></div>
<p>Rather than rely solely on our domain expertise a better option would
be to convert these published estimates into a prior distribution. There
are many ways this could be done. Below we will explore several.</p>
<div class="section level3">
<h3 id="approach-1-mean-and-variance-of-published-estimates">Approach 1: Mean and variance of published estimates<a class="anchor" aria-label="anchor" href="#approach-1-mean-and-variance-of-published-estimates"></a>
</h3>
<p>One reasonable way to turn the 6 published estimates into a single
prior is to take the mean and the variance of the 6 estimates and then
use moment matching to convert them into a single beta distribution.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="op">(</span><span class="va">mu2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">SurvPriorData</span><span class="op">$</span><span class="va">phi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.935</span></span>
<span><span class="op">(</span><span class="va">var2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">SurvPriorData</span><span class="op">$</span><span class="va">phi</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.00027</span></span></code></pre></div>
<p>Looks like our domain knowledge wasn’t too far off! Now we can covert
these estimates into the <span class="math inline">\alpha</span> and
<span class="math inline">\beta</span> parameters as we did above:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Beta parameters</span></span>
<span><span class="va">alpha2</span> <span class="op">&lt;-</span> <span class="va">mu2</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">mu2</span><span class="op">)</span><span class="op">/</span><span class="va">var2</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">mu2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">beta2</span> <span class="op">&lt;-</span> <span class="va">alpha2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">mu2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">beta_df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>phi <span class="op">=</span> <span class="va">phi</span>,</span>
<span>                      density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">phi</span>, <span class="va">alpha2</span>, <span class="va">beta2</span><span class="op">)</span>,</span>
<span>                      Approach <span class="op">=</span> <span class="st">"Published means"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">beta_df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">beta_df</span>, <span class="va">beta_df2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">beta_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">phi</span>, y <span class="op">=</span> <span class="va">density</span>, color <span class="op">=</span> <span class="va">Approach</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
<p>As you can see, even though the means of the two priors are not that
different, the variance is much smaller on the prior based on published
estimates, resulting in a much more informative prior (this prior
suggests we’re much more sure about the plausible values of <span class="math inline">\phi</span>).</p>
</div>
<div class="section level3">
<h3 id="approach-2-mean-and-variance-of-published-estimates">Approach 2: Mean and variance of published estimates<a class="anchor" aria-label="anchor" href="#approach-2-mean-and-variance-of-published-estimates"></a>
</h3>
<p>One of the reasons the informative prior based on published survival
estimates is so narrow is that it ignores the study-specific
uncertainties associated with each survival estimate. One could argue
that ignoring this source of uncertainty leads to a prior that is too
confident in the possible values of <span class="math inline">\phi</span>.</p>
<p>However, incorporating study-specific uncertainty is not so
straightforward. One clever approach is to convert estimates from each
study into separate beta distributions, simulate survival estimates from
each distribution, and then estimate “hyper-parameters” from all of the
simulations together<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;h/t to Nathan Hostetter, a USGS researcher, for
supplying example code and data to implement these ideas.&lt;/p&gt;"><sup>1</sup></a>. Understanding how this approach works is
best done through example.</p>
<p>Let’s start by using moment matching to estimate the <span class="math inline">\alpha</span> and <span class="math inline">\beta</span> parameters associated with each
individual study. To do this, we’ll take advantage of the way
<code>R</code> performs operations on vectors so we can just plug the
columns from the data frame directly into our formulas:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">alpha3</span> <span class="op">&lt;-</span> <span class="va">SurvPriorData</span><span class="op">$</span><span class="va">phi</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">SurvPriorData</span><span class="op">$</span><span class="va">phi</span><span class="op">)</span><span class="op">/</span><span class="va">SurvPriorData</span><span class="op">$</span><span class="va">se</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">SurvPriorData</span><span class="op">$</span><span class="va">phi</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 111.86  41.40  27.25 131.60 131.60  81.90</span></span>
<span><span class="op">(</span><span class="va">beta3</span> <span class="op">&lt;-</span> <span class="va">alpha3</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">SurvPriorData</span><span class="op">$</span><span class="va">phi</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.887 3.600 1.434 8.400 8.400 8.100</span></span></code></pre></div>
<p>Next, we will simulate a bunch of survival estimates from each
distribution. The easiest way to do this is to create an empty matrix to
hold all of the values and then loop through each study to simulate the
survival probabilities:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Number of simulated values from each distribution.</span></span>
<span><span class="va">nSims</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span></span>
<span><span class="co">## Empty matrix to store the simulated survival probabilities</span></span>
<span><span class="va">sim_phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">nSims</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">SurvPriorData</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">SurvPriorData</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="va">sim_phi</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nSims</span>, <span class="va">alpha3</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="va">beta3</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now hopefully you can see why this approach is so clever. We now have
30000 plausible values of adult female survival probability that are
consistent with published studies and reflect multiple sources of
uncertainty about this vital rate<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Beyond this specific example, simulating data from your
prior is a very useful way to ensure that the prior produces values are
consistent with your domain expertise. Simulating data from the priors
and then checking that these simulated data are generally consistent
with plausible values you would expect in real data is a potentially
important step in Bayesian inference (called &lt;em&gt;prior predictive
checks&lt;/em&gt;), especially for complicated models where interactions
between multiple parameters can potentially generate unexpected support
for implausible data. For more information about doing prior predictive
checks, see this &lt;a href="https://betanalpha.github.io/assets/case_studies/principled_bayesian_workflow.html" class="external-link"&gt;great
overview&lt;/a&gt; from Michael Betancourt.&lt;/p&gt;'><sup>2</sup></a>.</p>
<p>From these simulated values, we can now estimate “hyper-parameters”
for a single beta distribution that will serve as our prior. First, we
estimate the mean and variance of the simulated values:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">mu3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sim_phi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9352</span></span>
<span><span class="op">(</span><span class="va">var3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">sim_phi</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.001093</span></span></code></pre></div>
<p>You can see that the variance of these samples is much larger than
for approach 1, reflecting the additional source of uncertainty in
approach 2. Now we use the same moment matching code as before to
generate and visualize the prior:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Beta parameters</span></span>
<span><span class="va">alpha4</span> <span class="op">&lt;-</span> <span class="va">mu3</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">mu3</span><span class="op">)</span><span class="op">/</span><span class="va">var3</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">mu3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">beta4</span> <span class="op">&lt;-</span> <span class="va">alpha4</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">mu3</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">beta_df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>phi <span class="op">=</span> <span class="va">phi</span>,</span>
<span>                      density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">phi</span>, <span class="va">alpha4</span>, <span class="va">beta4</span><span class="op">)</span>,</span>
<span>                      Approach <span class="op">=</span> <span class="st">"Simulated"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">beta_df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">beta_df</span>, <span class="va">beta_df3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sim_phi</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>                 fill <span class="op">=</span>  <span class="va">WILD6900_colors</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">WILD6900_colors</span><span class="op">$</span><span class="va">name</span> <span class="op">==</span> <span class="st">"success"</span><span class="op">]</span>, </span>
<span>                 binwidth <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">beta_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">phi</span>, y <span class="op">=</span> <span class="va">density</span>, color <span class="op">=</span> <span class="va">Approach</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="priors_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="questions-to-consider3">Questions to consider<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;h/t again to Nathan Hostetter for engaging discussions
about these issues&lt;/p&gt;"><sup>3</sup></a><a class="anchor" aria-label="anchor" href="#questions-to-consider3"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p><strong>Informative vs vague</strong>: On one hand, we want
posteriors to reflect (and be affected by) prior knowledge. On the other
hand, why collect more data if we basically know the answer?</p></li>
<li><p><strong>How to assess ‘sensitivity to the prior’</strong>:
Ideally, we should test how sensitive our inferences are to the choice
of prior distribution. Should this be quantified by a change in the
posterior mean, standard deviation, etc? If the posterior is unaffected
by the prior, why go through the trouble of using informative
priors?</p></li>
<li><p><strong>Process vs sampling noise</strong>: The studies used to
create the priors reflect a range of conditions and population
trajectories. In approach 1, we assume that the point estimates of
survival reflect the process noise across populations. In approach 2, we
use the uncertainty from each study to capture both the sampling and
process uncertainty. Which sources of uncertainty should we care about
when developing a prior?</p></li>
<li><p><strong>Domain expertise</strong>: Incorporating sampling
uncertainty may increased prior weight for survival values that conflict
with our domain expertise (for example, values much lower than we think
are plausible). However, these values are consistent with possible
survival values from published studies. How should we treat priors that
are at the boundary of our statistical and domain expertise?</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="prior-predictive-checks">Prior Predictive Checks<a class="anchor" aria-label="anchor" href="#prior-predictive-checks"></a>
</h2>
<p>One issue with priors is that they can do unexpected things when they
undergo transformations. This means that a prior might look diffuse but
can accidentally be very informative because of how your model is
written. See <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.13407" class="external-link uri">https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.13407</a>
for a great paper on this.</p>
<p>For instance, let’s say that polar bear survival <span class="math inline">\phi</span> is a function of the age of the
individual, with cubs having much lower survival than adults:</p>
<p><span class="math display">logit(\phi_i) = \beta_0 +
\beta_1*age_i</span></p>
<p>We might be tempted to use something simple like a uniform for both
<span class="math inline">\beta</span> terms:</p>
<p><span class="math display">\beta_0 \sim Uniform(-5, 5)</span>
However, what does that imply about <span class="math inline">\phi</span>? For instance, if <span class="math inline">\beta_1</span> is 0 and we have no data, <span class="math inline">\phi</span> looks like:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">beta0</span>, main <span class="op">=</span> <span class="st">"Prior"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">beta0</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Posterior"</span>, xlab <span class="op">=</span> <span class="st">'Survival'</span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/unnamed-chunk-11-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Uh-oh!</p>
<p>In Nimble, you can run your model <strong>without data</strong> and
monitor the latent variables to double check that your priors are doing
what you expect. This is called a Prior Predictive Check and is a very
useful tool.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Ramsay, M.A. and Stirling, I., 1988. Reproductive biology and ecology
of female polar bears (<em>Ursus maritimus</em>). <em>Journal of
Zoology</em>, 214(4), pp.601-633.</p>
<p>Regehr, E.V., Hostetter, N.J., Wilson, R.R., Rode, K.D., Martin, M.S.
and Converse, S.J., 2018. Integrated population modeling provides the
first empirical estimates of vital rates and abundance for polar bears
in the Chukchi Sea. <em>Scientific reports</em>, 8(1), p.16780.</p>
</div>
<div class="section level2">
<h2 id="homework-questions">Homework Questions:<a class="anchor" aria-label="anchor" href="#homework-questions"></a>
</h2>
<ol style="list-style-type: decimal">
<li>You are studying a population of gopher tortoises, but you don’t
have a lot of data on survival. You want to model juvenile and adult
survival as: <span class="math inline">(\phi_i = \beta_0[age_i])</span>.
You comb through the literature and find the following information.
Using this information, choose a prior for <span class="math inline">\beta_0</span>. Defend your choice of prior. (Note:
you can choose to model <span class="math inline">\beta_0</span> as a
random or fixed effect, but be sure to defend your choice.)</li>
</ol>
<blockquote>
<p>At both study sites, apparent survival of immature tortoises was
significantly lower than for adult tortoises, averaging 82.4 ± 3.8% at
Conecuh and 69.7 ± 9.1% at Green Grove (Tuberville et al 2014)</p>
</blockquote>
<blockquote>
<p>Additionally, annual survivorship of immature tortoises (73.8%, 95%
CI = 56.3–86.1%) was significantly lower than that of adults (93.4%, 95%
CI = 88.6–96.9%) (Howell et al 2019)</p>
</blockquote>
<blockquote>
<p>Quarterly apparent survival did not differ significantly between size
classes, although point estimates were lower for small tortoises
(91.6% ± 3.5, 95% CI: 81.6%–96.4%; n = 19) than for large tortoises
(96.4% ± 2.5, 95% CI: 86.8%–99.1%; n = 13) (Stemle et. al 2024)</p>
</blockquote>
<blockquote>
<p>Apparent annual survival for adult tortoises averaged 0.98 ± 0.01 for
all years excluding the first two (Fig. 4). […] Survival of immature
tortoises was lower than that of adults and averaged 0.84 ± 0.05 across
years. (Tuberville et al 2008)</p>
</blockquote>
<ol start="2" style="list-style-type: decimal">
<li><p>The 2021 Species Status Assessment (SSA) for gopher tortoises
used informed priors on juvenile and adult survival to model population
viability across the Southeast USA. For juvenile tortoises, they used a
beta distribution with a mean of 0.75 and a standard deviation of 0.06.
For adult tortoises, they used a beta with mean 0.96 and a standard
deviation of 0.03. Write out the two beta distributions they used in
math form. Visually compare these distributions with the prior you chose
in Question 1.</p></li>
<li><p>Imagine we have an intercept-only occupancy model where <span class="math inline">logit(\psi) = \alpha</span>. We want to put an
uninformative prior on <span class="math inline">\alpha</span> but
aren’t sure what will happen when it goes through the logit
transformation. Use R to simulate each of the following priors 5000
times, and then graph each prior and the resulting posterior of <span class="math inline">\psi</span> in ggplot. Which ones, if any, seem
reasonably uninformative?</p></li>
</ol>
<ul>
<li><span class="math inline">\alpha \sim Normal(0, 10)</span></li>
<li>
<span class="math inline">\alpha \sim Gamma(10, 10)</span> (shape,
rate parameterization)</li>
<li><span class="math inline">\alpha \sim Beta(.3, .3)</span></li>
<li><span class="math inline">\alpha \sim Exp(1)</span></li>
<li>
<span class="math inline">\alpha \sim Cauchy(0, 1)</span> (location,
scale)</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>On a 1-10 scale, with 1 being the worst week ever and 10 being the
best, how would you rate this week’s content? What lingering
questions/confusion about the lecture or lab do you still have?</li>
</ol>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Clark Rushing, Heather Gaya.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
